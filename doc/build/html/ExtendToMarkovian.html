<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    
    <title>butools.reptrans.ExtendToMarkovian &mdash; butools v2.0 Manual</title>
    
    <link rel="stylesheet" type="text/css" href="_static/css/spc-bootstrap.css">
    <link rel="stylesheet" type="text/css" href="_static/css/spc-extend.css">
    <link rel="stylesheet" href="_static/scipy.css" type="text/css" >
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" >
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/js/copybutton.js"></script>
    <link rel="top" title="butools v2.0 Manual" href="index.html" >
    <link rel="up" title="Representation Transformation Tools (butools.reptrans)" href="reptrans.html" >
    <link rel="next" title="butools.reptrans.FindMarkovianRepresentation" href="FindMarkovianRepresentation.html" >
    <link rel="prev" title="butools.reptrans.TransformToAcyclic" href="TransformToAcyclic.html" > 
  </head>
  <body>

  <div class="container">
    <div class="header">
    </div>
  </div>


    <div class="container">
      <div class="main">
        
	<div class="row-fluid">
	  <div class="span12">
	    <div class="spc-navbar">
              
    <ul class="nav nav-pills pull-left">
        <li class="active"><a href="["></a></li>
        <li class="active"><a href="]"></a></li>
	
        <li class="active"><a href="index.html">butools v2.0 Manual</a></li>
	
          <li class="active"><a href="reptrans.html" accesskey="U">Representation Transformation Tools (<code class="docutils literal"><span class="pre">butools.reptrans</span></code>)</a></li> 
    </ul>
              
              
    <ul class="nav nav-pills pull-right">
      <li class="active">
        <a href="genindex.html" title="General Index"
           accesskey="I">index</a>
      </li>
      <li class="active">
        <a href="FindMarkovianRepresentation.html" title="butools.reptrans.FindMarkovianRepresentation"
           accesskey="N">next</a>
      </li>
      <li class="active">
        <a href="TransformToAcyclic.html" title="butools.reptrans.TransformToAcyclic"
           accesskey="P">previous</a>
      </li>
    </ul>
              
	    </div>
	  </div>
	</div>
        

	<div class="row-fluid">
      <div class="spc-rightsidebar span3">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="TransformToAcyclic.html"
                        title="previous chapter">butools.reptrans.TransformToAcyclic</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="FindMarkovianRepresentation.html"
                        title="next chapter">butools.reptrans.FindMarkovianRepresentation</a></p>

        </div>
      </div>
          <div class="span9">
            
        <div class="bodywrapper">
          <div class="body" id="spc-section-body">
            
  <div class="section" id="butools-reptrans-extendtomarkovian">
<h1>butools.reptrans.ExtendToMarkovian<a class="headerlink" href="#butools-reptrans-extendtomarkovian" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="butools.reptrans.ExtendToMarkovian">
<code class="descclassname">butools.reptrans.</code><code class="descname">ExtendToMarkovian</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#butools.reptrans.ExtendToMarkovian" title="Permalink to this definition">¶</a></dt>
<dd><table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="86%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Matlab:</td>
<td><code class="code docutils literal"><span class="pre">[beta,</span> <span class="pre">B]</span> <span class="pre">=</span> <span class="pre">ExtendToMarkovian(alpha,</span> <span class="pre">A,</span> <span class="pre">maxSize,</span> <span class="pre">precision)</span></code></td>
</tr>
<tr class="row-even"><td>Mathematica:</td>
<td><code class="code docutils literal"><span class="pre">{beta,</span> <span class="pre">B}</span> <span class="pre">=</span> <span class="pre">ExtendToMarkovian[alpha,</span> <span class="pre">A,</span> <span class="pre">maxSize,</span> <span class="pre">precision]</span></code></td>
</tr>
<tr class="row-odd"><td>Python/Numpy:</td>
<td><code class="code docutils literal"><span class="pre">beta,</span> <span class="pre">B</span> <span class="pre">=</span> <span class="pre">ExtendToMarkovian(alpha,</span> <span class="pre">A,</span> <span class="pre">maxSize,</span> <span class="pre">precision)</span></code></td>
</tr>
</tbody>
</table>
<p>Assume we have an existing monocyclic (or acyclic)
representation of a matrix-exponential distribution
described by matrix A and vector alpha such that A is
Markovian but alpha is not. This procedure appends an
appropriate Erlang tail to the representation that makes
the result Markovian (both the generator matrix and the
initial vector parameter), while keeping the distribution
the same. In <a class="reference internal" href="#r12" id="id1">[R12]</a> it is proven that this is always
possible if the initial (alpha,A) defines a distribuion
(non-negative density).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>alpha</strong> : vector, shape (1,M)</p>
<blockquote>
<div><p>The (non-Markovian) initial vector</p>
</div></blockquote>
<p><strong>A</strong> : matrix, shape (M,M)</p>
<blockquote>
<div><p>The (Markovian) transient generator.</p>
</div></blockquote>
<p><strong>maxSize</strong> : int, optional</p>
<blockquote>
<div><p>The procedure stops if more than maxSize new phases
are required. The default value is 100</p>
</div></blockquote>
<p><strong>precision</strong> : double, optional</p>
<blockquote>
<div><p>The initial vector is considered to be valid if the
smallest entry is greater than -precision. The
default value is 1e-14</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>beta</strong> : vector, shape (1,N)</p>
<blockquote>
<div><p>The Markovian initial vector (N&gt;=M)</p>
</div></blockquote>
<p><strong>B</strong> : matrix, shape (N,N)</p>
<blockquote class="last">
<div><p>The Markovian transient generator (N&gt;=M).</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r12" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R12]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id2">2</a>)</em> Mocanu, S., Commault, C.: &#8220;Sparse representations
of phase-type distributions,&#8221; Stoch. Models 15,
759-778 (1999)</td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>For Matlab:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">alpha</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">];</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">;</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">];</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">TransformToMonocyclic</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">disp</span><span class="p">(</span><span class="n">B</span><span class="p">);</span>
<span class="go">           -1            1            0            0</span>
<span class="go">            0      -2.6536       2.6536            0</span>
<span class="go">            0            0      -2.6536       2.6536</span>
<span class="go">            0     0.047227            0      -2.6536</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Cm</span> <span class="o">=</span> <span class="n">SimilarityMatrix</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">);</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">beta</span> <span class="o">=</span> <span class="n">alpha</span><span class="o">*</span><span class="n">Cm</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">disp</span><span class="p">(</span><span class="n">beta</span><span class="p">);</span>
<span class="go">     0.045649  -0.00043836    -0.088811       1.0436</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">m</span><span class="p">,</span><span class="n">M</span><span class="p">]</span> <span class="o">=</span> <span class="n">ExtendToMarkovian</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span><span class="n">B</span><span class="p">);</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">disp</span><span class="p">(</span><span class="n">m</span><span class="p">);</span>
<span class="go">     0.015399     0.010192     0.017621     0.018114    0.0087991      0.10333      0.82655</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">disp</span><span class="p">(</span><span class="n">M</span><span class="p">);</span>
<span class="go">           -1            1            0            0            0            0            0</span>
<span class="go">            0      -2.6536       2.6536            0            0            0            0</span>
<span class="go">            0            0      -2.6536       2.6536            0            0            0</span>
<span class="go">            0     0.047227            0      -2.6536       2.6064            0            0</span>
<span class="go">            0            0            0            0      -3.2908       3.2908            0</span>
<span class="go">            0            0            0            0            0      -3.2908       3.2908</span>
<span class="go">            0            0            0            0            0            0      -3.2908</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Cm</span> <span class="o">=</span> <span class="n">SimilarityMatrix</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="n">M</span><span class="p">);</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">err</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">B</span><span class="o">*</span><span class="n">Cm</span><span class="o">-</span><span class="n">Cm</span><span class="o">*</span><span class="n">M</span><span class="p">);</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">disp</span><span class="p">(</span><span class="n">err</span><span class="p">);</span>
<span class="go">   5.7254e-15</span>
</pre></div>
</div>
<p>For Mathematica:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">alpha</span> <span class="o">=</span> <span class="p">{</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">};</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="p">{{</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">},{</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">},{</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">}};</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">TransformToMonocyclic</span><span class="p">[</span><span class="n">A</span><span class="p">];</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Print</span><span class="p">[</span><span class="n">B</span><span class="p">];</span>
<span class="go">{{-1., 1., 0, 0},</span>
<span class="go"> {0, -2.6535898384862247, 2.6535898384862247, 0},</span>
<span class="go"> {0, 0, -2.6535898384862247, 2.6535898384862247},</span>
<span class="go"> {0, 0.047227424799192015, 0, -2.6535898384862247}}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Cm</span> <span class="o">=</span> <span class="n">SimilarityMatrix</span><span class="p">[</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">];</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">beta</span> <span class="o">=</span> <span class="n">alpha</span><span class="o">.</span><span class="n">Cm</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Print</span><span class="p">[</span><span class="n">beta</span><span class="p">];</span>
<span class="go">{0.0456492140620947, -0.0004383562608946817, -0.08881092881059305, 1.0436000710093931}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">{</span><span class="n">m</span><span class="p">,</span><span class="n">M</span><span class="p">}</span> <span class="o">=</span> <span class="n">ExtendToMarkovian</span><span class="p">[</span><span class="n">beta</span><span class="p">,</span><span class="n">B</span><span class="p">];</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Print</span><span class="p">[</span><span class="n">m</span><span class="p">];</span>
<span class="go">{0.015398906730148602, 0.010192332530307258, 0.017620759235113224, 0.018114065982724338, 0.008799081502100216, 0.10332742932145772, 0.8265474246981488}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Print</span><span class="p">[</span><span class="n">M</span><span class="p">];</span>
<span class="go">{{-1., 1., 0., 0., 0., 0., 0.},</span>
<span class="go"> {0., -2.6535898384862247, 2.6535898384862247, 0., 0., 0., 0.},</span>
<span class="go"> {0., 0., -2.6535898384862247, 2.6535898384862247, 0., 0., 0.},</span>
<span class="go"> {0., 0.047227424799192015, 0., -2.6535898384862247, 2.6063624136870325, 0., 0.},</span>
<span class="go"> {0., 0., 0., 0., -3.290797259447432, 3.290797259447432, 0.},</span>
<span class="go"> {0., 0., 0., 0., 0., -3.290797259447432, 3.290797259447432},</span>
<span class="go"> {0., 0., 0., 0., 0., 0., -3.290797259447432}}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Cm</span> <span class="o">=</span> <span class="n">SimilarityMatrix</span><span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="n">M</span><span class="p">];</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">err</span> <span class="o">=</span> <span class="n">Norm</span><span class="p">[</span><span class="n">B</span><span class="o">.</span><span class="n">Cm</span><span class="o">-</span><span class="n">Cm</span><span class="o">.</span><span class="n">M</span><span class="p">];</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Print</span><span class="p">[</span><span class="n">err</span><span class="p">];</span>
<span class="go">2.7864548696465478*^-15</span>
</pre></div>
</div>
<p>For Python/Numpy:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">alpha</span> <span class="o">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">matrix</span><span class="p">([[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">matrix</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">TransformToMonocyclic</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">[[-1.       1.       0.       0.     ]</span>
<span class="go"> [ 0.      -2.65359  2.65359  0.     ]</span>
<span class="go"> [ 0.       0.      -2.65359  2.65359]</span>
<span class="go"> [ 0.       0.04723  0.      -2.65359]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Cm</span> <span class="o">=</span> <span class="n">SimilarityMatrix</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">beta</span> <span class="o">=</span> <span class="n">alpha</span><span class="o">*</span><span class="n">Cm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span>
<span class="go">[[  4.56492e-02  -4.38356e-04  -8.88109e-02   1.04360e+00]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="p">,</span><span class="n">M</span> <span class="o">=</span> <span class="n">ExtendToMarkovian</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="go">[[ 0.0154   0.01019  0.01762  0.01811  0.0088   0.10333  0.82655]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="go">[[-1.       1.       0.       0.       0.       0.       0.     ]</span>
<span class="go"> [ 0.      -2.65359  2.65359  0.       0.       0.       0.     ]</span>
<span class="go"> [ 0.       0.      -2.65359  2.65359  0.       0.       0.     ]</span>
<span class="go"> [ 0.       0.04723  0.      -2.65359  2.60636  0.       0.     ]</span>
<span class="go"> [ 0.       0.       0.       0.      -3.2908   3.2908   0.     ]</span>
<span class="go"> [ 0.       0.       0.       0.       0.      -3.2908   3.2908 ]</span>
<span class="go"> [ 0.       0.       0.       0.       0.       0.      -3.2908 ]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Cm</span> <span class="o">=</span> <span class="n">SimilarityMatrix</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="n">M</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">err</span> <span class="o">=</span> <span class="n">la</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">B</span><span class="o">*</span><span class="n">Cm</span><span class="o">-</span><span class="n">Cm</span><span class="o">*</span><span class="n">M</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
<span class="go">4.28823049948e-15</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container container-navbar-bottom">
      <div class="spc-navbar">
        
      </div>
    </div>
    <div class="container">
    <div class="footer">
    <div class="row-fluid">
    <ul class="inline pull-left">
      <li>
        &copy; Copyright 2013-2014, The BuTools Team.
      </li>
      <li>
      Last updated on Jun 19, 2015.
      </li>
      <li>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.1.
      </li>
    </ul>
    </div>
    </div>
    </div>
  </body>
</html>